<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Snake Game</title>
</head>

<body>
    <div id="score">0</div>

    <canvas id="gameCanvas" width="300" height="300">
        <canvas>

            <script>
                //Constants//
                const CANVAS_BORDER_COLOUR = 'black';
                const CANVAS_BACKGROUND_COLOUR = 'white';
                const SNAKE_COLOUR = 'lightgreen';
                const SNAKE_BORDER_COLOUR = 'darkgreen';
                const FOOD_COLOUR = 'red';
                const FOOD_BORDER_COLOUR = 'darkred';


                //for snake to work, we need to know the location of it
                //to do this, we can represent the snake as an array of coordinates
                //to create a snake in the middle of the canvas 150,150 

                let snake = [
                    { x: 150, y: 150 },
                    { x: 140, y: 150 },
                    { x: 130, y: 150 },
                    { x: 120, y: 150 },
                    { x: 110, y: 150 },
                ]

                //the users score
                let score = 0;

                // Horizonal velocity
                let dx = 10;
                //vertivcal valocity
                let dy = 0;



                //Get the canvas element using the id gameCanvas we specified earlier. 
                var gameCanvas = document.getElementById('gameCanvas');
                //then return the canvas “2d” context, which means we will be drawing into 2D space.
                var ctx = gameCanvas.getContext('2d');
                //select the color to fill the canvas
                ctx.fillStyle = CANVAS_BACKGROUND_COLOUR;
                //select the colour for the border of the canvas
                ctx.strokestyle = CANVAS_BORDER_COLOUR;
                // Draw a "filled" rectangle to cover the entire canvas
                ctx.fillRect(0, 0, gameCanvas.width, gameCanvas.height);
                // Draw a border around the entire canvas
                ctx.strokeRect(0, 0, gameCanvas.width, gameCanvas.height);


                //START GAME
                main();
                //create the first food location 
                createFood();
                //call changeDirection whenever the key is pressed 
                document.addEventListener("keydown", changeDirection);

                function main() {

                    if (didGameEnd()) return;

                    setTimeout(function onTick() {
                        clearCanvas();
                        drawFood();
                        advanceSnake();
                        drawSnake();

                        //call man again 
                        main();
                    }, 100)
                }

                //Change the background coloe of the canvas to CANVAS_BACGROUND and 
                //draw a border around it

                function clearCanvas() {
                    //select the color to fill the canvas
                    ctx.fillStyle = CANVAS_BACKGROUND_COLOUR;
                    //select the colour for the border of the canvas
                    ctx.strokestyle = CANVAS_BORDER_COLOUR;

                    // Draw a "filled" rectangle to cover the entire canvas
                    ctx.fillRect(0, 0, gameCanvas.width, gameCanvas.height);
                    // Draw a border around the entire canvas
                    ctx.strokeRect(0, 0, gameCanvas.width, gameCanvas.height);
                }

                //returns trun of the head of the snake touched another part of the game or any of the walls
                function didGameEnd() {
                    for (let i = 4; i < snake.length; i++ {
                        const didCollide = snake[i].x === snake[0].x && snake[i].y === snake[0].y
                        if (didCollide) return true
                    }

                    const hitLeftWall = snake[0].x < 0;
                    const hitRightWall = snake[0].x > gameCanvas.width - 10;
                    const hitTopWall = snake[0].y < 0;
                    const hitBottomWall = snake[0].y > gameCanvas.height - 10;

                    return hitLeftWall || hitRightWall || hitTopWall || hitBottomWall
                }

                //DRAW FOOD ON CANVAS
                function drawFood() {
                    ctx.fillStyle = FOOD_COLOUR;
                    ctx.strokestyle = FOOD_BORDER_COLOUR;
                    ctx.fillRect(foodX, foodY, 10, 10);
                    ctx.strokeRect(foodX, foodY, 10, 10)
                }

                //to test how out advanceSnake func works, we can temporarily call it before the drawSnake func
                //move on step to the right 
                advanceSnake()
                //change vertical velocity to 0 
                dx = 0;
                //change horizonal velocity to 10
                dy = -10;
                //move one step up
                advanceSnake();
                //draw snake on canveas
                drawSnake();


                // * Advances the snake by changing the x-coordinates of its parts
                // * according to the horizontal velocity and the y - coordinates of its parts
                //  * according to the vertical veolocity
                function advanceSnake() {
                    const head = { x: snake[0].x + dx, y: snake[0].y + dy };
                    snake.unshift(head);
                    snake.pop();
                }


                //CREATING AND DRAWING THE SNAKE  
                // to display the snake on the canvas, we can write a function to draw a rectangle for each pair of coordinates
                function drawSnake() {
                    //loop through the snake parts drawing each part on canvas
                    snake.forEach(drawSnakePart)
                }

                //Draws a part of the snake on canvas
                //@param object snakePart - coordinates where tha part should be drawn
                function drawSnakePart(snakePart) {
                    //set the color of the snake 
                    ctx.fillStyle = SNAKE_COLOUR;

                    //set the border colour of the snake 
                    ctx.strokeStyle = SNAKE_BORDER_COLOUR;

                    //Draw  filled rectangle to represent the snake a the coordinates
                    // the part is located
                    ctx.fillRect(snakePart.x, snakePart.y, 10, 10);

                    //Draw a border around the snake
                    ctx.strokeRect(snakePart.x, snakePart.y, 10, 10);
                }

            </script>

</body>

</html>